import React, { useState } from 'react';
import { Button } from './ui/button';
import { Card, CardContent, CardHeader, CardTitle } from './ui/card';
import { toast } from 'sonner@2.0.3';
import { projectId } from '../utils/supabase/info';

interface SeedDataProps {
  accessToken: string;
}

const SeedData: React.FC<SeedDataProps> = ({ accessToken }) => {
  const [seeding, setSeeding] = useState(false);

  const makeRequest = async (url: string, data: any) => {
    const response = await fetch(`https://${projectId}.supabase.co/functions/v1/make-server-f7a2cc63${url}`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${accessToken}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    });

    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.error || 'Request failed');
    }

    return response.json();
  };

  const seedPortfolio = async () => {
    const portfolioItems = [
      {
        title: "Романтическая церемония в Тоскане",
        description: "Незабываемая свадьба среди виноградников с видом на холмы Тосканы. Церемония прошла на закате с живой музыкой и изысканной флористикой.",
        location: "Тоскана, Италия",
        category: "Зарубежные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1538677859585-f8d2193ffa2b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx0dXNjYW55JTIwd2VkZGluZyUyMHZpbGxhJTIwc3Vuc2V0fGVufDF8fHx8MTc1ODM4NTE4MXww&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-09-15"
      },
      {
        title: "Элегантная свадьба на Санторини",
        description: "Минималистичная церемония на белоснежной террасе с захватывающим видом на Эгейское море. Стиль: современная элегантность.",
        location: "Санторини, Греция",
        category: "Зарубежные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1519123833858-f99014eb53c7?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxncmVlY2UlMjBzYW50b3JpbmklMjB3ZWRkaW5nJTIwd2hpdGUlMjBibHVlfGVufDF8fHx8MTc1ODM4NTE4Mnww&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-08-20"
      },
      {
        title: "Сказочная свадьба в замке Несвиж",
        description: "Торжественная церемония в историческом замке XVI века. Роскошный банкет в бальном зале с аутентичным декором.",
        location: "Замок Несвиж, Беларусь",
        category: "Выездные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1551546897-0cf94d9bb428?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwZmxvd2VycyUyMG1pbmltYWwlMjBlbGVnYW50fGVufDF8fHx8MTc1ODM4NTE4Mnww&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-07-12"
      },
      {
        title: "Природная романтика у озера Нарочь",
        description: "Церемония на берегу самого большого озера Беларуси. Естественная красота природы в сочетании с изысканным декором.",
        location: "Озеро Нарочь, Беларусь",
        category: "Выездные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1698897050888-c18a15b6703e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxlbGVnYW50JTIwd2VkZGluZyUyMGNlcmVtb255JTIwb3V0ZG9vciUyMG5hdHVyYWwlMjBsaWdodHxlbnwxfHx8fDE3NTgzODUxODF8MA&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-06-28"
      },
      {
        title: "Шикарная свадьба в Провансе",
        description: "Утончённая церемония среди лавандовых полей с французским шармом. Винтажный стиль и изысканная кухня.",
        location: "Прованс, Франция",
        category: "Зарубежные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1653936644618-b13b3357ce78?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwY2FrZSUyMGVsZWdhbnQlMjB3aGl0ZSUyMHJvc2VzfGVufDF8fHx8MTc1ODM4NTE4M3ww&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-05-18"
      },
      {
        title: "Современная свадьба в лофте",
        description: "Стильная городская свадьба в индустриальном лофт-пространстве. Современный дизайн и креативная подача.",
        location: "Подмосковье, Россия",
        category: "Выездные свадьбы",
        imageUrl: "https://images.unsplash.com/photo-1739216906046-afc47ed589fb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwcmluZ3MlMjBsdXh1cnklMjBtaW5pbWFsfGVufDF8fHx8MTc1ODM4NTE4M3ww&ixlib=rb-4.1.0&q=80&w=1080",
        date: "2024-10-05"
      }
    ];

    for (const item of portfolioItems) {
      await makeRequest('/portfolio', item);
    }
  };

  const seedBlog = async () => {
    const blogPosts = [
      {
        title: "10 лучших мест для свадьбы в Европе",
        content: `Европа предлагает невероятное разнообразие локаций для свадьбы. От романтических замков Франции до живописных островов Греции — каждое место имеет свою уникальную атмосферу.

**1. Тоскана, Италия**
Регион, где виноградники встречаются с холмами, создаёт идеальный фон для романтической церемонии. Винодельни предлагают аутентичную атмосферу и великолепную кухню.

**2. Санторини, Греция**
Белоснежные церкви на фоне бирюзового моря создают сказочную атмосферу. Закаты на Санторини считаются одними из самых красивых в мире.

**3. Прованс, Франция**
Лавандовые поля и старинные шато создают атмосферу французского романа. Идеально для тех, кто ценит изысканность и утончённость.

**4. Чешский Крумлов, Чехия**
Средневековый город с узкими улочками и замком на холме. Идеально для камерной свадьбы в сказочной атмосфере.

**5. Побережье Амальфи, Италия**
Скалистые берега и лимонные рощи создают уникальную атмосферу средиземноморской роскоши.

Каждая из этих локаций требует особого подхода к планированию и знания местных традиций.`,
        excerpt: "Откройте для себя самые романтические места Европы для проведения свадебной церемонии. От Тосканы до Санторини — выбираем идеальную локацию.",
        category: "Локации",
        tags: ["европа", "локации", "зарубежные свадьбы", "тоскана", "санторини"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1465146344425-f00d5f5c8f07?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxldXJvcGUlMjB3ZWRkaW5nJTIwdmVudWUlMjByb21hbnRpY3xlbnwxfHx8fDE3NTgzODUxODF8MA&ixlib=rb-4.1.0&q=80&w=1080"
      },
      {
        title: "Планирование свадьбы: чек-лист за 12 месяцев",
        content: `Планирование свадьбы — это увлекательный, но сложный процесс. Наш подробный чек-лист поможет ничего не забыть.

**За 12 месяцев до свадьбы:**
- Определить бюджет
- Выбрать дату и время
- Составить предварительный список гостей
- Начать поиск площадки

**За 9-10 месяцев:**
- Забронировать площадку
- Выбрать свадебного организатора
- Заказать услуги фотографа
- Начать поиск платья

**За 6-8 месяцев:**
- Отправить save-the-date
- Заказать кейтеринг
- Выбрать музыкальное сопровождение
- Заказать цветы и декор

**За 3-4 месяца:**
- Отправить приглашения
- Заказать торт
- Выбрать обручальные кольца
- Спланировать медовый месяц

**За 1 месяц:**
- Провести репетицию
- Подтвердить все услуги
- Подготовить аварийный план

Помните: главное — это ваши эмоции и чувства, а не идеальное исполнение каждой детали.`,
        excerpt: "Пошаговое руководство по планированию свадьбы с подробным чек-листом на каждый месяц. Ничего не забудьте в подготовке к вашему особенному дню.",
        category: "Планирование",
        tags: ["планирование", "чек-лист", "организация", "подготовка"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1511632765486-a01980e01a18?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwcGxhbm5pbmclMjBub3RlYm9vayUyMGNoZWNrbGlzdHxlbnwxfHx8fDE3NTgzODUxODF8MA&ixlib=rb-4.1.0&q=80&w=1080"
      },
      {
        title: "Свадебные тренды 2024: что будет популярно",
        content: `2024 год принёс множество интересных тенденций в свадебной индустрии. Рассказываем о главных трендах.

**Цветовые палитры:**
- Тёплые землистые оттенки
- Монохромные схемы
- Яркие акценты в пастельной основе

**Декор и флористика:**
- Асимметричные композиции
- Сухоцветы в сочетании со свежими
- Минималистичные арки

**Стили церемоний:**
- Микро-свадьбы (до 30 гостей)
- Многодневные празднования
- Эко-френдли подход

**Развлечения:**
- Интерактивные зоны
- Персонализированные активности
- Live-музыка вместо DJ

**Кулинарные тренды:**
- Локальная кухня
- Веганские опции
- Интерактивные фуд-станции

Главный тренд — аутентичность. Пары выбирают то, что действительно отражает их личность.`,
        excerpt: "Изучаем главные свадебные тренды 2024 года: от цветовых палитр до новых форматов празднования. Вдохновляйтесь актуальными идеями.",
        category: "Тренды",
        tags: ["тренды 2024", "стиль", "декор", "современные свадьбы"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1606800052300-5d5a37f843db?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwdHJlbmRzJTIwMjAyNCUyMGZsb3dlcnN8ZW58MXx8fHwxNzU4Mzg1MTgxfDA&ixlib=rb-4.1.0&q=80&w=1080"
      },
      {
        title: "Красивые места Беларуси для выездной церемонии",
        content: `Беларусь богата удивительными местами для проведения свадебной церемонии. От исторических замков до природных локаций.

**Замки и усадьбы:**
- Несвижский замок — жемчужина архитектуры XVI века
- Мирский замок — средневековая красота
- Усадьба в Ружанах — романтика барокко

**Природные локации:**
- Озеро Нарочь — "белорусское море"
- Беловежская пуща — древний лес
- Браславские озёра — "белорусская Швейцария"

**Городские площадки:**
- Верхний город в Минске
- Центр Гродно у замка
- Витебский амфитеатр

**Агроусадьбы:**
- Аутентичная белорусская атмосфера
- Возможность размещения гостей
- Традиционная кухня

**Советы по выбору:**
- Учитывайте сезонность
- Продумайте логистику для гостей
- Узнайте о разрешениях для фотосъёмки

Беларусь предлагает уникальные возможности для создания незабываемой свадьбы в национальном стиле.`,
        excerpt: "Откройте для себя самые красивые места Беларуси для свадебной церемонии. От исторических замков до живописных озёр — выбираем идеальную локацию.",
        category: "Локации",
        tags: ["беларусь", "выездные свадьбы", "замки", "природа", "несвиж"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1520637836862-4d197d17c11a?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxiZWxhcnVzJTIwY2FzdGxlJTIwd2VkZGluZyUyMGhpc3RvcmljfGVufDF8fHx8MTc1ODM4NTE4MXww&ixlib=rb-4.1.0&q=80&w=1080"
      },
      {
        title: "Как выбрать свадебного фотографа: полное руководство",
        content: `Выбор фотографа — одно из важнейших решений при планировании свадьбы. Эти кадры станут вашими воспоминаниями на всю жизнь.

**Определите стиль:**
- Классический — традиционные постановочные кадры
- Репортажный — живые эмоции момента
- Художественный — творческий подход
- Документальный — история дня без вмешательства

**Как искать фотографа:**
- Изучайте портфолио целиком, не только лучшие кадры
- Читайте отзывы реальных пар
- Встречайтесь лично перед заключением договора
- Обращайте внимание на обработку фотографий

**Важные вопросы:**
- Сколько часов включено в пакет?
- Есть ли второй фотограф?
- Когда вы получите готовые фотографии?
- Что включает пост-обработка?

**Бюджет:**
- Экономия на фотографе — не лучшая идея
- Средняя стоимость составляет 10-15% от общего бюджета
- Уточните все дополнительные расходы заранее

**Подготовка к съёмке:**
- Обсудите список обязательных кадров
- Расскажите о важных моментах и людях
- Продумайте тайминг для различных локаций

Помните: хороший фотограф не только технически грамотен, но и умеет работать с людьми.`,
        excerpt: "Подробное руководство по выбору свадебного фотографа. Узнайте, на что обратить внимание, какие вопросы задать и как не ошибиться в выборе.",
        category: "Советы",
        tags: ["фотограф", "советы", "выбор", "свадебная съёмка"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1511765224389-37f0e77cf0eb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwcGhvdG9ncmFwaGVyJTIwY2FtZXJhfGVufDF8fHx8MTc1ODM4NTE4MXww&ixlib=rb-4.1.0&q=80&w=1080"
      },
      {
        title: "Бюджет свадьбы: как правильно распределить средства",
        content: `Планирование бюджета — один из самых важных этапов подготовки к свадьбе. Расскажем, как грамотно распределить средства.

**Средние пропорции бюджета:**
- Площадка и банкет: 40-50%
- Наряды молодожёнов: 10-15%
- Фото и видеосъёмка: 10-15%
- Флористика и декор: 8-12%
- Музыка и развлечения: 8-10%
- Транспорт: 3-5%
- Резерв на непредвиденные расходы: 10%

**Как экономить без ущерба качеству:**
- Выбирайте сезон свадеб с меньшим спросом
- Рассмотрите пятницу или воскресенье вместо субботы
- Используйте сезонные цветы в декоре
- Пригласите меньше гостей для более камерного торжества

**На чём не стоит экономить:**
- Фотограф и видеограф — это ваши воспоминания
- Качество еды — гости это оценят
- Координатор свадьбы — поможет избежать стресса

**Скрытые расходы, о которых забывают:**
- Чаевые персоналу
- Дополнительные часы аренды
- Страховка мероприятия
- Подарки подружкам невесты и друзьям жениха

**Как контролировать бюджет:**
- Ведите детальную таблицу расходов
- Запрашивайте подробные сметы у поставщиков
- Закладывайте 15-20% на непредвиденные траты
- Определите приоритеты заранее

Помните: красивая свадьба не обязательно дорогая. Главное — грамотное планирование и расстановка приоритетов.`,
        excerpt: "Полное руководство по планированию свадебного бюджета. Узнайте, как правильно распределить средства и на чём можно сэкономить без ущерба качеству.",
        category: "Планирование",
        tags: ["бюджет", "планирование", "экономия", "расходы", "деньги"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1757256137041-0aab889db199?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx3ZWRkaW5nJTIwYnVkZ2V0JTIwcGxhbm5pbmclMjBjYWxjdWxhdG9yfGVufDF8fHx8MTc1OTE1NzYxMHww&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral"
      },
      {
        title: "Свадьба в Азии: лучшие направления для романтического путешествия",
        content: `Азия предлагает удивительные возможности для проведения свадебной церемонии. От тропических пляжей до древних храмов.

**Популярные направления:**

**Бали, Индонезия**
- Пляжные церемонии на закате
- Храмы с уникальной архитектурой
- Spa-процедуры для молодожёнов
- Относительно доступные цены

**Пхукет, Таиланд**
- Роскошные курорты
- Экзотическая кухня
- Возможность совместить с медовым месяцем
- Простое оформление документов

**Санья, Китай**
- Современные отели с первоклассным сервисом
- Тропический климат круглый год
- Уникальная культура
- Развитая туристическая инфраструктура

**Нашанбе, Узбекистан**
- Восточная сказка в архитектуре
- Аутентичная атмосфера
- Доступные цены
- Близость к России и Беларуси

**Особенности планирования:**
- Учитывайте сезон дождей
- Изучите местные традиции и обычаи
- Подготовьте документы заранее
- Рассмотрите символическую церемонию

**Что включить в программу:**
- Традиционные церемонии благословения
- Фотосессии в национальных костюмах
- Дегустация местной кухни
- Экскурсии по достопримечательностям

**Практические советы:**
- Бронируйте за 6-8 месяцев
- Уточните визовые требования
- Выберите координатора, знающего местные особенности
- Продумайте комфорт для пожилых гостей

Азиатские свадьбы — это сочетание экзотики, роскоши и незабываемых впечатлений для всех участников.`,
        excerpt: "Открываем лучшие направления в Азии для проведения свадебной церемонии. От Бали до Узбекистана — выбираем идеальное место для экзотической свадьбы.",
        category: "Локации",
        tags: ["азия", "зарубежные свадьбы", "бали", "таиланд", "экзотика"],
        published: true,
        imageUrl: "https://images.unsplash.com/photo-1616146965569-db1a51cfa0ed?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxkZXN0aW5hdGlvbiUyMHdlZGRpbmclMjBhc2lhJTIwYmVhY2glMjBjZXJlbW9ueXxlbnwxfHx8fDE3NTkxNTc2MjN8MA&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral"
      }
    ];

    for (const post of blogPosts) {
      await makeRequest('/blog', post);
    }
  };

  const handleSeedData = async () => {
    setSeeding(true);
    try {
      await seedPortfolio();
      await seedBlog();
      toast.success('Демо-данные успешно добавлены!');
    } catch (error) {
      console.error('Error seeding data:', error);
      toast.error('Ошибка при добавлении данных');
    } finally {
      setSeeding(false);
    }
  };

  return (
    <Card className="max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle>Добавить демо-данные</CardTitle>
      </CardHeader>
      <CardContent className="space-y-4">
        <p className="text-gray-600">
          Добавьте примеры проектов портфолио и статей блога для демонстрации возможностей CMS.
        </p>
        <p className="text-sm text-gray-500">
          Это добавит 6 проектов в портфолио и 7 статей в блог с качественными изображениями и контентом.
        </p>
        <Button
          onClick={handleSeedData}
          disabled={seeding}
          className="w-full bg-rose-600 hover:bg-rose-700"
        >
          {seeding ? 'Добавление данных...' : 'Добавить демо-данные'}
        </Button>
      </CardContent>
    </Card>
  );
};

export default SeedData;